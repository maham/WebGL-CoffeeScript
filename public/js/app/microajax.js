// Generated by CoffeeScript 1.8.0
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(function() {
    var MicroAjax;
    return MicroAjax = (function() {
      function MicroAjax(url, callbackFunction) {
        this.url = url;
        this.callbackFunction = callbackFunction;
        this.stateChange = __bind(this.stateChange, this);
        this.postBody = arguments[2] || "";
        this.request = this.getRequest();
        if (this.request) {
          this.request.onreadystatechange = this.stateChange;
          if (this.postBody !== "") {
            this.request.open("POST", this.url, true);
            this.request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
            this.request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            this.request.setRequestHeader('Connection', 'close');
          } else {
            this.request.open("GET", this.url, true);
          }
          this.request.send(this.postBody);
        }
      }

      MicroAjax.prototype.stateChange = function(object) {
        if (this.request.readyState === 4) {
          return this.callbackFunction(this.request.responseText);
        }
      };

      MicroAjax.prototype.getRequest = function() {
        if (window.ActiveXObject) {
          return new ActiveXObject('Microsoft.XMLHTTP');
        }
        if (window.XMLHttpRequest) {
          return new XMLHttpRequest;
        }
        return false;
      };

      return MicroAjax;

    })();
  });

}).call(this);
